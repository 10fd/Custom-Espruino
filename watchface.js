g.reset();

var img = {
  width : 176, height : 176, bpp : 2,
  transparent : -1,
  palette : new Uint16Array([0,65535,2047,2]),
  buffer : require("heatshrink").decompress(atob("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"))
}

g.drawImage(img, 0, 10);

Graphics.prototype.setFontLicorice = function(scale) {
  // Actual height 20 (19 - 0)
  g.setFontCustom(atob("AAAAAABgAABwAAAAAAAAAAAHAAAOAAAcAAA8AAA4AABwAABwAAAAAAAAAAADwAAP8AAODAAOf4AM+eAG4ZAGwMgDAAwBgAwAwBwAMHwAD/gAAAAAAAAAACAAADP+AD/BAD4AgDwAAAAAMAAAOACAOADgHADgHABgHgBgGwAwGYAwGMAYOEAIOCAGOB4D+A8AAAwAAA+AAADAAAAwAgAYAxAMAxgGAwwDAYYBAIcBgMOAwGNgwB85wA8PwAAGAAAHAAADgAADwAABwAAA4AAAYAAAeAAAbAAA4v4A4/+A78DAXmAAHBAADAgAAAwAAB4AAAAIAAAGAAGDAAPBgAPAwB/gYA9gIAYwMAYYMAGIGADEGABjGAAx+AAIeAAAAAAAAfAAA/wAA8YAA4EAAweAAwfAAwcgAwYwA4YYAYMYAYEMAYGMAMB8AAAAAAQAAA4gIA4Z/AYPwAMHgAGHAADHAABngAAXwAAPYAAAAAAAAAAAOAAAPgcAMwfAMcZgGGYwCB4YDA4MBgeMAwf+AYMcAMMAACMAAAMAAAAAAAAAAAAeAAAfgAAYwAAYQAAYYPAMIfwMM8IGN4ACHwADHgABngAAAAAAAABgAABwAA4w"), 46, atob("BAgOBw0OEQ4OCw8NBA=="), 25+(scale<<8)+(1<<16));
}

function draw() {
  var d = new Date();
  var h = d.getHours()
  var m = d.getMinutes();
  var time = (" "+h).substr(-2) + ":" + ("0"+m).substr(-2);

  const mCur = d.getMinutes();

  const X = 140, Y = 76;
  g.setColor(255, 0, 0)
  g.setFont("Licorice");
  g.setFontAlign(0,1);
  g.drawString(time, X, Y, true);

  var dateStr = require("locale").date(d);
  g.setFont("Vector", 8);
  g.drawString(dateStr, X, Y+15, true);
  g.update;
}

draw();
var secondInterval = setInterval(draw, 60000 - (Date.now() % 60000));

Bangle.on('lcdPower',on=>{
  if (secondInterval) clearInterval(secondInterval);
  secondInterval = undefined;
  if (on) {
    secondInterval = setInterval(draw, 60000 - (Date.now() % 60000));
    draw();
  }
});

Bangle.setUI("clock");
Bangle.loadWidgets();
Bangle.drawWidgets();